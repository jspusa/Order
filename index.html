<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>Ë®ÇÂñÆÁî¢ÁîüÂô® Order Generator</title>
  <meta name="viewport" content="width=1050">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    body {
      font-family: 'Noto Sans TC', Arial, sans-serif;
      background: linear-gradient(120deg, #f6f7fb 0%, #e9f0ff 100%);
      padding: 0; margin: 0;
      color: #273042;
    }
    .container {
      margin: 36px auto 48px auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 8px 40px rgba(40,60,140,0.12);
      max-width: 1050px;
      padding: 40px 34px 30px 34px;
      position: relative;
      overflow: visible;
    }
    .header-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 28px;
      margin-bottom: 34px;
      position: relative;
    }
    .header-bar h1 {
      color: #2c3e50;
      font-size: 2.1rem;
      font-weight: 800;
      flex: 1;
      text-align: center;
      letter-spacing: 1.2px;
      margin: 0;
      display: flex; align-items: center; justify-content: center;
      gap: 10px;
    }
    .header-bar .fa-cube { color: #68a0fa; }
    .factory-switch {
      background-color: #f3f7fa;
      padding: 9px 19px;
      border-radius: 9px;
      box-shadow: 0 2px 8px #e5eaf1;
      display: flex; gap: 14px;
      align-items: center;
      font-size: 1rem;
    }
    .factory-switch label {
      margin: 0;
      color: #5682c2;
      font-weight: bold;
      cursor: pointer;
      display: flex; align-items: center;
    }
    .factory-switch input[type="radio"] { accent-color: #3b79d5; margin-right: 5px; }

    .box-size-button {
      background: #e9f0ff;
      color: #5682c2;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      border-radius: 7px;
      padding: 9px 20px;
      font-weight: 600;
      box-shadow: 0 2px 10px #dde8f9;
      transition: background 0.19s, color 0.19s;
      display: flex; align-items: center; gap: 8px;
    }
    .box-size-button:hover { background: #d7e3fa; color: #3364ad;}
    .export-button {
      background: #10b7e8;
      color: #fff;
      border: none;
      border-radius: 7px;
      padding: 11px 24px;
      font-size: 1.08rem;
      margin: 28px 0 0 0;
      font-weight: 700;
      box-shadow: 0 2px 16px #bee4f4c4;
      transition: background 0.19s;
      display: flex; align-items: center; gap: 10px;
    }
    .export-button:hover { background: #0993b9;}

    select, input[type="number"], input[type="text"] {
      width: 100%; padding: 9px 14px; margin-bottom: 16px; font-size: 1.03rem;
      border-radius: 7px; border: 1px solid #d3d9e7; box-sizing: border-box;
      transition: border .2s, box-shadow .2s;
    }
    select:focus, input[type="number"]:focus, input[type="text"]:focus {
      border-color: #68a0fa;
      box-shadow: 0 0 7px #97c7f799;
      outline: none;
    }

    .product-button {
      background: #68a0fa;
      color: #fff;
      padding: 8px 18px;
      border: none;
      border-radius: 7px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      box-shadow: 0 1px 8px #dbe7f3;
      transition: background 0.2s, color 0.2s;
      display: inline-flex; align-items: center; gap: 5px;
    }
    .product-button:hover { background: #376fd7; }
    .search-container { position: relative; margin-bottom: 22px; }
    .search-input {
      width: 100%; padding: 10px 14px; font-size: 1rem; box-sizing: border-box;
      border-radius: 7px; border: 1.5px solid #c2d7ef; margin-bottom: 0;
    }
    .search-results {
      position: absolute; top: 45px; left: 0; width: 100%; background-color: #fff;
      border: 1px solid #c9d8ef; border-top: none; max-height: 180px;
      overflow-y: auto; z-index: 100;
      border-radius: 0 0 7px 7px;
      box-shadow: 0 8px 16px #97b5e733;
    }
    .search-result-item {
      padding: 9px 14px; cursor: pointer; font-size: 1rem; color: #304976;
      transition: background 0.15s;
    }
    .search-result-item:hover {
      background: #eef4fd;
      color: #1b2f50;
    }
    .table-responsive { overflow-x: auto; }
    table {
      width: 100%; margin-top: 12px; border-collapse: separate; border-spacing: 0;
      background: #fafdff;
      border-radius: 12px;
      box-shadow: 0 1px 16px #dbe8fa60;
      overflow: hidden;
    }
    th, td {
      padding: 14px 8px;
      border-bottom: 1px solid #e3e8f0;
      font-size: 1.01rem;
    }
    th {
      background: #eaf1fc;
      color: #375a7f;
      font-weight: 700;
      border-bottom: 2px solid #b7d2f6;
    }
    tr:last-child td { border-bottom: none; }
    tr:hover td { background: #f0f5fe; }
    .action-button, .remove-button, .lock-button {
      background: #e0e7f3; color: #5c6f8f;
      padding: 5px 9px; margin: 2px 1px;
      border: none; border-radius: 6px; cursor: pointer;
      font-size: 15px; font-weight: bold;
      transition: background 0.2s;
    }
    .action-button:hover { background: #b0c9e7;}
    .remove-button { background: #fa7878; color: #fff;}
    .remove-button:hover { background: #e84242;}
    .lock-button { background: #ffd76b; color: #925700;}
    .lock-button:hover { background: #ffe091;}
    .locked td { background: #f7f7fa; }
    .box-size-A { color: #23a363; font-weight: bold;}
    .box-size-B { color: #2984d6; font-weight: bold;}
    .box-size-C { color: #fd7e14; font-weight: bold;}
    .box-size-D { color: #8c4acf; font-weight: bold;}
    .box-size-icon {
      display: inline-block; width: 14px; height: 14px; margin-right: 5px;
      vertical-align: middle; border-radius: 50%;
    }
    .box-size-icon-A { background-color: #23a363; }
    .box-size-icon-B { background-color: #2984d6; }
    .box-size-icon-C { background-color: #fd7e14; }
    .box-size-icon-D { background-color: #8c4acf; }
    .totals-container { text-align: right; margin-top: 24px;}
    .total {
      font-weight: 700; font-size: 1.08rem; margin-bottom: 2px;
    }
    .box-counts { margin-top: 3px; font-size: 1rem; color: #6679a8;}
    .container-info { margin: 22px 0 12px 0; }
    .progress-container {
      width: 100%; background: #e3eaf8; border-radius: 8px; margin: 10px 0;
      position: relative; height: 23px;
    }
    .progress-bar {
      height: 100%; border-radius: 8px; width: 0%; text-align: center;
      color: white; line-height: 23px; font-weight: bold; background: linear-gradient(90deg,#3fb7fd 40%,#5ccfb1 100%);
      transition: width 0.35s;
      font-size: 1rem;
      letter-spacing: 0.1em;
    }
    /* ÂΩàÁ™ó */
    .modal {
      display: none; position: fixed; z-index: 2000; left: 0; top: 0;
      width: 100%; height: 100%; overflow: auto;
      background: rgba(0,0,0,0.16);
      animation: fadeIn .3s;
    }
    @keyframes fadeIn {
      from {opacity: 0;} to {opacity: 1;}
    }
    .modal-content {
      background: #fff; margin: 6% auto; padding: 30px 26px; border-radius: 16px;
      width: 92%; max-width: 470px; position: relative;
      box-shadow: 0 12px 48px #5664ff40;
      animation: modalPopIn .34s;
    }
    @keyframes modalPopIn {
      from {transform: scale(0.9);}
      to {transform: scale(1);}
    }
    .close-modal {
      color: #aab2c6; font-size: 32px; font-weight: bold; cursor: pointer;
      position: absolute; right: 20px; top: 10px;
      transition: color 0.18s;
    }
    .close-modal:hover, .close-modal:focus { color: #222; }
    .modal-content p { margin: 12px 0 6px 0; }
    /* Êñ∞ÂìÅÁî¢ÁîüÂô®ÊµÆÂãïÈàï */
    #newItemGeneratorBtn {
      position: fixed; top: 22px; right: 30px;
      background: linear-gradient(120deg,#10b7e8 60%,#7ad0e0 100%);
      color: #fff; border: none; border-radius: 50%; width: 45px; height: 45px;
      cursor: pointer; font-weight: bold; font-size: 2rem;
      box-shadow: 0 2px 14px #13e6f442;
      display: flex; align-items: center; justify-content: center;
      z-index: 2100;
      transition: box-shadow 0.2s, background 0.2s;
    }
    #newItemGeneratorBtn:hover { box-shadow: 0 4px 24px #23baff74; background: #0aa2c3; }
    /* user-tipÊèêÁ§∫ */
    .user-tip {
      position: fixed; left: 50%; bottom: 44px; transform: translateX(-50%);
      background: #384b65d7; color: #fff; padding: 17px 36px;
      border-radius: 13px; font-size: 1.08rem; z-index: 3500;
      box-shadow: 0 2px 16px #0002; opacity: 1; transition: opacity 0.4s;
    }
    .user-tip.error { background: #e63946d7;}
    .user-tip.success { background: #37be6dd7;}
    /* ÈüøÊáâÂºè */
    @media (max-width: 1150px) {
      .container { padding: 22px 8px;}
    }
    @media (max-width: 600px) {
      .container {padding: 9px;}
      .header-bar h1 { font-size: 1.1rem;}
      .modal-content {padding: 14px 6px;}
      .product-button{font-size: .9rem;}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header-bar">
      <div class="factory-switch">
        <label><input type="radio" name="countrySelect" value="VN" checked> Ë∂äÂçóÂª†</label>
        <label><input type="radio" name="countrySelect" value="TW"> Âè∞ÁÅ£Âª†</label>
        <label><input type="radio" name="countrySelect" value="Others"> ÂÖ∂‰ªñ</label>
      </div>
      <h1>
        <i class="fa-solid fa-cube"></i> Ë®ÇÂñÆÁî¢ÁîüÂô®
        <span style="font-size: 1rem; color:#8ab2e0; margin-left:12px;font-weight:400;">Order Generator</span>
      </h1>
      <button class="box-size-button" onclick="openModal()">
        <i class="fa-solid fa-ruler-combined"></i> Á¥ôÁÆ±Â∞∫ÂØ∏
      </button>
    </div>
    <div class="search-container">
      <input type="text" id="searchInput" class="search-input" placeholder="üîé ‰ª•ÂìÅËôüÊêúÂ∞ã/Âø´ÈÄüÂä†ÂÖ•" oninput="searchProduct()">
      <div id="searchResults" class="search-results"></div>
    </div>
    <div class="table-responsive">
      <table id="productTable">
        <thead>
          <tr>
            <th>Â∫èËôü</th>
            <th>ÂìÅËôü</th>
            <th>ÂåÖÊï∏</th>
            <th>Ë¢ãÊï∏/ÁõíÊï∏</th>
            <th>ÁõÆÊ®ôÊï∏Èáè</th>
            <th>ÁÆ±Êï∏</th>
            <th>Ê£ßÊùøÊï∏</th>
            <th>Á¥ôÁÆ±</th>
            <th>Êìç‰Ωú</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="totals-container">
      <div class="total">
        <i class="fa-solid fa-boxes-stacked"></i>
        Á∏ΩÂåÖÊï∏: <span id="totalQuantity">0</span> |
        Á∏ΩÁÆ±Êï∏: <span id="totalCartons">0</span> |
        Á∏ΩÊ£ßÊùøÊï∏: <span id="totalPallets">0</span>
      </div>
      <div class="box-counts">
        <span class="box-size-icon box-size-icon-A"></span>AÊ£ßÊùø: <span id="countA">0</span> |
        <span class="box-size-icon box-size-icon-B"></span>BÊ£ßÊùø: <span id="countB">0</span> |
        <span class="box-size-icon box-size-icon-C"></span>CÊ£ßÊùø: <span id="countC">0</span>
      </div>
    </div>
    <div id="containerInfo" class="container-info"></div>
    <button class="export-button" onclick="exportToExcel()">
      <i class="fa-solid fa-file-arrow-down"></i> ÂåØÂá∫ Excel
    </button>
  </div>

  <!-- Á¥ôÁÆ±Ë¶èÊ†º Modal -->
  <div id="boxSizeModal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <h2 style="color:#3777eb;font-size:1.25rem;margin-bottom:16px;">
        <i class="fa-solid fa-ruler-combined"></i> Á¥ôÁÆ±Ë¶èÊ†ºÂ∞∫ÂØ∏
      </h2>
      <div style="font-size:1.06rem;line-height:1.8;">
        <p><span class="box-size-icon box-size-icon-A"></span> <b>A</b>Ôºö50√ó40√ó30cmÔºà20√ó16√ó12Ôºâ</p>
        <p><span class="box-size-icon box-size-icon-B"></span> <b>B</b>Ôºö58.5√ó34.5√ó35cmÔºà23√ó14√ó14Ôºâ</p>
        <p><span class="box-size-icon box-size-icon-C"></span> <b>C</b>Ôºö50√ó40√ó40cmÔºà20√ó16√ó16Ôºâ</p>
        <p><span class="box-size-icon box-size-icon-D"></span> <b>D</b>Ôºö48√ó38√ó28cmÔºà19√ó15√ó11Ôºâ<strong> (‰∏≠‰∏âÁÆ±)</strong></p>
      </div>
    </div>
  </div>

  <!-- Êñ∞ÂìÅÁî¢ÁîüÂô®ÊµÆÂãïÊåâÈàï -->
  <button id="newItemGeneratorBtn" title="Êñ∞ÂìÅÁî¢ÁîüÂô®">
    <i class="fa-solid fa-plus"></i>
  </button>
  <!-- Êñ∞ÂìÅÁî¢ÁîüÂô® Modal -->
  <div id="newItemModal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeNewItemModal()">&times;</span>
      <h2 style="color:#3376ed"><i class="fa-solid fa-cube"></i> Êñ∞ÂìÅÁî¢ÁîüÂô®</h2>
      <div style="font-size:0.97rem;color:#3d5c90;margin-bottom:12px;">
        ‰æùÂ∫èËº∏ÂÖ•Êñ∞ÂïÜÂìÅË≥áË®äÔºå<span style="color:#eb3d3d;">* ÂøÖÂ°´</span>
      </div>
      <label>ÂìÅËôü <span style="color:#eb3d3d">*</span>
        <input type="text" id="newItemCode" placeholder="ÂøÖÂ°´ (Â¶Ç AFA11AM)">
      </label>
      <label>ÂìÅÂêç <span style="color:#eb3d3d">*</span>
        <input type="text" id="newItemName" placeholder="ÂøÖÂ°´">
      </label>
      <label>Á¥ôÁÆ±Ë¶èÊ†º <span style="color:#eb3d3d">*</span>
        <select id="newItemBoxSize" onchange="boxSizeChanged()">
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
        </select>
      </label>
      <label>Ê£ßÊùøÁÆ±Êï∏ <span style="color:#eb3d3d">*</span>
        <input type="number" id="newItemPallet" placeholder="Ëá™ÂãïÂ∏∂ÂÖ•ÔºåÂèØ‰øÆÊîπ">
      </label>
      <label>ÁîüÁî¢ÂúãÂà•
        <select id="newItemCountry">
          <option value="VN">VN (Ë∂äÂçó)</option>
          <option value="TW">TW (Âè∞ÁÅ£)</option>
          <option value="Others">Others</option>
        </select>
      </label>
      <label>ÂåÖË£ùÈ°ûÂûã
        <select id="newItemPackagingType" onchange="packagingTypeChanged()">
          <option value="single">ÂñÆÂåÖ</option>
          <option value="bag">Ë¢ãË£ù</option>
          <option value="box">ÁõíË£ù</option>
        </select>
      </label>
      <div id="packagingFields"></div>
      <button class="product-button" style="background:#3a7afe;" onclick="addNewItemLine()">
        <i class="fa-solid fa-cart-plus"></i> Âä†ÂÖ•
      </button>
      <hr>
      <div style="font-size:.95rem;color:#8895b1;margin-bottom:6px;">ÁµêÊûúÔºàÂèØË§áË£ΩÁµ¶Â∑•Á®ãÂ∏´ÔºâÔºö</div>
      <textarea id="newItemResult" style="width:100%;height:80px;background:#f6f7fa;border-radius:8px;border:1px solid #d1dae4;padding:8px 11px;font-size:.96rem;"></textarea>
      <button class="product-button" style="background:#23c87d;" onclick="copyNewItems()">
        <i class="fa-solid fa-copy"></i> Ë§áË£ΩÁµêÊûú
      </button>
    </div>
  </div>
  <!-- xlsx -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <script>
    // ÂïÜÂìÅË≥áÊñôÁØÑ‰æã
const allProducts = [
  { productCode: "AFA11AM", productName: "AFreschi-Classic Turkey Tendon Thin Stick (100g /pk)ÔºõAFK package (120 units /CTN)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA12AM", productName: "AFreschi-Classic Turkey Tendon Braided Stick(100g /pk)ÔºõAFK package (120 units /CTN)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA13AM", productName: "AFreschi-Classic Turkey Tendon Slice (100g /pk)ÔºõAFK package (100 units /CTN)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA14AM", productName: "AFreschi-Classic Turkey Tendon Flake(100g /pk)ÔºõAFK package (80 units /CTN)", boxSize: "A", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA21AM", productName: "AFreschi-Soft Turkey Tendon & Pumpkin strip (100g /pk)ÔºõAFK package (120 units /CTN)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA22AM", productName: "AFreschi-Soft Turkey Tendon Strip (100g /pk)ÔºõAFK package (120 units /CTN)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA31AM", productName: "AFreschi-Wrapped Turkey Tendon with Chicken Stick (100g /pk)ÔºõAFK package (100 units /CTN)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA32AM", productName: "AFreschi-Wrapped Turkey Tendon with Brown Rice Stick(100g /pk)ÔºõAFK package (100 units /CTN)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFA25AM", productName: "AFreschi-Classic Turkey Tendon Coil-L(85g /pk)ÔºõAFK package (70 units /CTN)", boxSize: "A", perCarton: 70, perPack: null, perBox: null, perPallet: 43, country: "VN" },
  { productCode: "AFA135AM", productName: "AFreschi-Classic Turkey Tendon Coil-S(85g /pk)ÔºõAFK package (70 units /CTN)", boxSize: "A", perCarton: 70, perPack: null, perBox: null, perPallet: 44, country: "VN" },
  { productCode: "GTS01", productName: "Gootoe - Turkey Tendon Strip (85g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTR01", productName: "Gootoe - Turkey Tendon Ring_S(72g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTB01", productName: "Gootoe - Turkey Tendon Bone_S(72g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTP01", productName: "Gootoe - Turkey Tendon Rope_S(72g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTZ01", productName: "Gootoe - Turkey Tendon Pretzel_S(72g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTA01", productName: "Gootoe - Turkey Tendon Braid_S(90g x 120)", boxSize: "B", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTC01", productName: "Gootoe - Sliced Turkey Tendon (85g x 120)", boxSize: "B", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTR03", productName: "Gootoe - Turkey Tendon Ring_M(90g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTB03", productName: "Gootoe - Turkey Tendon Bone_M(90g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTP03", productName: "Gootoe - Turkey Tendon Rope_M(90g x 100)", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTS03", productName: "Gootoe - Turkey Tendon Stick_M(90g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTZ03", productName: "Gootoe - Turkey Tendon Pretzel_M(90g x 120)", boxSize: "B", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTB05", productName: "Gootoe - Turkey Tendon Bone_L(100g x 100)", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTP05", productName: "Gootoe - Turkey Tendon Rope_L(100g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTB07", productName: "Gootoe - Turkey tendon lolipop 15g x 5pcs (75g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSF01", productName: "Soft Turkey Tendon Strip with Pumpkin (85g x 150)", boxSize: "A", perCarton: 150, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSF02", productName: "Soft Turkey Tendon Strip (85g x 150)", boxSize: "A", perCarton: 150, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTSL01", productName: "Gootoe - Turkey Tendon Strip (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTRL01", productName: "Gootoe - Turkey Tendon Ring_S (454g x 24)", boxSize: "C", perCarton: 24, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTPL01", productName: "Gootoe - Turkey Tendon Rope_S (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTBL01", productName: "Gootoe - Turkey Tendon Bone_S (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTAL01", productName: "Gootoe - Turkey Tendon Braid_S (454g x 38)", boxSize: "C", perCarton: 38, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTCL01", productName: "Gootoe - Turkey Tendon Sliced (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTRL03", productName: "Gootoe - Turkey Tendon Ring_M (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTPL03", productName: "Gootoe - Turkey Tendon Rope_M (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTBL03", productName: "Gootoe - Turkey Tendon Bone_M (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTZL03", productName: "Gootoe - Turkey Tendon Pretzel_M (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTPL05", productName: "Gootoe - Turkey Tendon Rope_L (454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GTBL05", productName: "Gootoe - Turkey Tendon Bone_L(454g x 30)", boxSize: "C", perCarton: 30, perPack: null, perBox: null, perPallet: 30, country: "VN" },
  { productCode: "GSFL01", productName: "Soft Turkey Tendon Strip with Pumpkin (454g x 38)", boxSize: "A", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSFL02", productName: "Soft Turkey Tendon Strip (454g x 38)", boxSize: "A", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATS01AM", productName: "Natural Turkey Tendon Strip (100g)", boxSize: "A", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATB01AM", productName: "Afreschi srl - Natural Turkey Tendon Bone_S(72g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATR01AM", productName: "Afreschi srl - Natural Turkey Tendon Ring_S(72g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATP01AM", productName: "Afreschi srl - Natural Turkey Tendon Rope_S(72g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATZ01AM", productName: "Afreschi srl - Natural Turkey Tendon Pretzel_S(72g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATA01AM", productName: "Afreschi srl - Natural Turkey Tendon Braid(90g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATB03AM", productName: "Afreschi srl - Natural Turkey Tendon Bone_M(90g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATR03AM", productName: "Afreschi srl - Natural Turkey Tendon Ring_M(90g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATP03AM", productName: "Afreschi srl - Natural Turkey Tendon Rope_M(90g)", boxSize: "A", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATZ03AM", productName: "Afreschi srl - Natural Turkey Tendon Pretzel_M(90g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATB05AM", productName: "Afreschi srl - Natural Turkey Tendon Bone_L(100g)", boxSize: "A", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATP05AM", productName: "Afreschi srl- Natural Turkey Tendon Rope_L(100g)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATAL01", productName: "Afreschi Natural Turkey Tendon Braid 8oz (GTA01:227g x 42)", boxSize: "A", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB01AM", productName: "Natural Turkey Tendon Bone_S (40 unitsÔºõ8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "TRP01AM", productName: "Natural Turkey Tendon Rope_S (40 unitsÔºõ8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "TTR01AM", productName: "Natural Turkey Tendon Ring_S (40 units /box ; 8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "TPZ01AM", productName: "Natural Turkey Tendon Pretzel_S (40 units /box ; 8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "KTB03AM", productName: "Natural Turkey Tendon Bone_M (20 units /box ; 8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TRP03AM", productName: "Natural Turkey Tendon Rope_M (20 units /box ; 8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TTR03AM", productName: "Natural Turkey Tendon Ring_M (20 unitsÔºõ8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TPZ03AM", productName: "Natural Turkey Tendon Pretzel-M (20 units /box ; 8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 20, perPallet: 36, country: "VN" },
  { productCode: "TRP05AM", productName: "Natural Turkey Tendon Rope_L (10 units /box ; 8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "KTB05AM", productName: "Natural Turkey Tendon Bone_L (10 unitsÔºõ8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "TTR05AM", productName: "Natural Turkey Tendon Ring_L (10 unitsÔºõ8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "TPZ05AM", productName: "Natural Turkey Tendon Pretzel_L (10 unitsÔºõ8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "TTS05AM", productName: "Natural Turkey Tendon Strip (10 units /box ; 8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 10, perPallet: 36, country: "VN" },
  { productCode: "KTB06AM", productName: "Natural Turkey Tendon Lollipop (40 unitsÔºõ8 boxes /CTN)", boxSize: "B", perCarton: 8, perPack: null, perBox: 40, perPallet: 36, country: "VN" },
  { productCode: "KTB01AM-4", productName: "Natural Turkey Tendon Bone_S (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTR01AM-4", productName: "Natural Turkey Tendon Ring_S (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRP01AM-4", productName: "Natural Turkey Tendon Rope_S (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZ01AM-4", productName: "Natural Turkey Tendon Pretzel_S (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB03AM-2", productName: "Natural Turkey Tendon Bone_M (80 units /CTN)", boxSize: "A", perCarton: 80, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRP03AM-2", productName: "Natural Turkey Tendon Rope_M (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTR03AM-2", productName: "Natural Turkey Tendon Ring_M (80 units /CTN)", boxSize: "A", perCarton: 80, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZ03AM-2", productName: "Natural Turkey Tendon Pretzel_M (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 2, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB05AM-1", productName: "Natural Turkey Tendon Bone_L (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRP05AM-1", productName: "Natural Turkey Tendon Rope_L (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTR05AM-1", productName: "Natural Turkey Tendon Ring_L (120 units /CTN)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZ05AM-1", productName: "Natural Turkey Tendon Pretzel_L (120 units /CTN)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTS05AM-1", productName: "Natural Turkey Tendon Strip (100 units /CTN)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTB06AM-4", productName: "Natural Turkey Tendon Lollipop (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTBL01", productName: "Afreschi Natural Turkey Tendon Bone 8oz_S-15g (227g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTRL01", productName: "Afreschi Natural Turkey Tendon Ring 8oz_S-12g (227g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZL01", productName: "Afreschi Natural Turkey Tendon Pretzel 8oz_S-12g (227g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRPL01", productName: "Afreschi Natural Turkey Tendon Rope 8oz_S-12g (227g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTBL03", productName: "Afreschi Natural Turkey Tendon Bone 10oz_M-36g (285g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTRL03", productName: "Afreschi Natural Turkey Tendon Ring 10oz_M-36g (285g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZL03", productName: "Afreschi Natural Turkey Tendon Pretzel 10oz_M-36g (285g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRPL03", productName: "Afreschi Natural Turkey Tendon Rope 10oz_M-36g (285g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTRL05", productName: "Afreschi Natural Turkey Tendon Ring 10oz_L-72g (285g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TRPL05", productName: "Afreschi Natural Turkey Tendon Rope 10oz_L-72g (285g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TPZL05", productName: "Afreschi Natural Turkey Tendon Pretzel 10oz_L-72g (285g x 36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "KTBL05", productName: "Afreschi Natural Turkey Tendon Bone 10oz_L-72g (285g x 30)", boxSize: "A", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "TTSL05", productName: "Afreschi Natural Turkey Tendon Strip 10oz (285g x 30)", boxSize: "A", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFML01", productName: "AFreschi Turkey Tendon Variety Pack 8oz_Small (227gx36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFML03", productName: "AFreschi Turkey Tendon Variety Pack 10oz_Medium (285gx36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AFML05", productName: "AFreschi Turkey Tendon Variety Pack 10oz_Large (285gx36)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASF01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Soft Sticks (170g x 100)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ABM01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Sticks_Œ≤-Carotene added (170g x 110)", boxSize: "A", perCarton: 110, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATN01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Star Bites (170g x 80)", boxSize: "A", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASA01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Mini Bars (170g x 80)", boxSize: "A", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ADT03", productName: "Natural Dental Treats-Real Turkey Meat (1kg x20 units /CTN)", boxSize: "A", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATJ01", productName: "Afreschi - Natural Turkey Jerky 4oz (113gx110)", boxSize: "A", perCarton: 110, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GTT01", productName: "Gootoe Turkey Tendon Twists 5oz_Small (142g*120)", boxSize: "B", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "GTT03", productName: "Gootoe Turkey Tendon Twists 5oz_Medium (142g*120)", boxSize: "B", perCarton: 120, perPack: null, perBox: null, perPallet: 36, country: "VN" },
  { productCode: "ASFL01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Soft Sticks (454g)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ABML01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Sticks_Œ≤-Carotene added (454g)", boxSize: "A", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATNL01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Star Bites (454g)", boxSize: "A", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASAL01", productName: "A Freschi Srl ‚Äì Natural Turkey Treats Mini Bars (454g)", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ATJL01", productName: "A Freschi Srl ‚Äì Natural Turkey Jerky (12oz-340g)", boxSize: "A", perCarton: 42, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCBL01", productName: "Gootoe - Chicken Fillet Jerky 454gx30", boxSize: "A", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCBL02", productName: "Gootoe - Chicken Jerky Breast 454gx36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCBL03", productName: "Gootoe - Chicken Chips 454gx28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL01", productName: "Gootoe - Soft Chicken Breast Strips 454gx36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL02", productName: "Gootoe - Soft Chicken Sticks 454gx36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL03", productName: "Gootoe - Soft Chicken Dental Chews with Chlorophyll, 1.5lb (681gx28)", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL04", productName: "Gootoe - Soft Chicken Knots 454gx30", boxSize: "A", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GSCL05", productName: "Gootoe - Soft Chicken Jerky Cuts 454gx36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL01", productName: "Gootoe - Chicken Sticks 1.5lb-681gx28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL02", productName: "Gootoe - Chicken Sticks With Chicken Liver 1.5lb-681gx28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL03", productName: "Gootoe - Chicken Sticks With Sweet Potato 1.5lb-681gx28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL04", productName: "Gootoe - Chicken Mini Sticks 1.5lb-681gx22", boxSize: "A", perCarton: 22, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL05", productName: "Gootoe - Chicken Roll 12oz-340gx24", boxSize: "A", perCarton: 24, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GCTL06", productName: "Gootoe - Chicken Dipped Sticks 1.5lb-681gx28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBS01", productName: "Gootoe - Buffalo Bites Stick _S (70units /CTN)", boxSize: "A", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBS03", productName: "Gootoe - Buffalo Bites Stick _L (70 units /CTN)", boxSize: "A", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBB01", productName: "Gootoe - Buffalo Bites Bone Shaped (60 units /CTN)", boxSize: "A", perCarton: 60, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBSL01", productName: "Gootoe - Buffalo Bites Stick (small) (S) 1.5lb-681g", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBSL03", productName: "Gootoe - Buffalo Bites Stick (Large) (L) 1.5lb-681g", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "GBBL01", productName: "Gootoe - Buffalo Bites Bone Shaped 1.5lb-681g", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD010", productName: "AFreschi Air-Dried Dog Food - USA Turkey Recipe(W-shaped)-454g", boxSize: "A", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD011", productName: "AFreschi Air-Dried Dog Food - USA Turkey Recipe(W-shaped)-1kg", boxSize: "A", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD070", productName: "AFreschi Air - Dried Dog Food - Turkey & Salmon Recipe(W-shaped)-454g", boxSize: "A", perCarton: 38, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "AWD071", productName: "AFreschi Air - Dried Dog Food - Turkey & Salmon Recipe(W-shaped)-1kg", boxSize: "A", perCarton: 20, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTS01-1", productName: "Turkey Tendon Strip (100 units /CTN)", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTB01-4", productName: "Turkey Tendon Bone_S (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTR01-4", productName: "Turkey Tendon Ring_S (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTB05-1", productName: "Turkey Tendon Bone_L (120 units /CTN)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VTB06-4", productName: "Turkey Tendon Lollipop (90 units /CTN)", boxSize: "A", perCarton: 90, perPack: 4, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "HDR01AM", productName: "Herz_ Turkey Tendon_Duo-Protein_Ring (S) (85g)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "HDP01AM", productName: "Herz_ Turkey Tendon_Duo-Protein_Rope(S)(85g)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "HDS03AM", productName: "Herz_ Turkey Tendon_Duo-Protein_Strip(85g)", boxSize: "A", perCarton: 120, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACBL01", productName: "AFreschi - Natural Chicken Fillet Jerky 454g*30", boxSize: "A", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACBL02", productName: "AFreschi - Natural Chicken Breast Jerky 454g*36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACBL03", productName: "AFreschi - Natural Chicken Chips 454g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL01", productName: "AFreschi - Natural Soft Chicken Breast Strips 454g*36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL02", productName: "AFreschi - Natural Soft Chicken Sticks 454g*36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL03", productName: "AFreschi - Natural Soft Chicken Dental Chews with Chlorophyll 681g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL04", productName: "AFreschi - Natural Soft Chicken Knots 454g*30", boxSize: "A", perCarton: 30, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ASCL05", productName: "AFreschi - Natural Soft Chicken Jerky Cuts 454g*36", boxSize: "A", perCarton: 36, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL01", productName: "AFreschi - Natural Chicken Sticks 681g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL02", productName: "AFreschi - Natural Chicken Sticks with Chicken Liver 681g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL03", productName: "AFreschi - Natural Chicken Sticks with Sweet Potato 681g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL04", productName: "AFreschi - Natural Chicken Sticks (Mini) 681g*22", boxSize: "A", perCarton: 22, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL05", productName: "AFreschi - Natural Chicken Roll 340g*24", boxSize: "A", perCarton: 24, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL06", productName: "AFreschi - Natural Chicken Dipped Sticks 681g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL07", productName: "AFreschi - Natural Chicken Dipped Rice Sticks 681g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL08", productName: "AFreschi - Natural Chicken Sliced 681g*24", boxSize: "A", perCarton: 24, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL09", productName: "AFreschi - Natural Chicken Dipped Rice Bone 454g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACTL10", productName: "AFreschi - Natural Chicken Sticks with Pumpkin 681g*28", boxSize: "A", perCarton: 28, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACA01", productName: "Afreschi - Natural Cat Treats (Chicken & Mackerel) -6oz-170gx100", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACA02", productName: "Afreschi - Natural Cat Treats (Buffalo& Chicken & Fish) -6oz-170gx100", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "ACA03", productName: "Afreschi - Natural Cat Treats (Turkey & Chicken & Mackerel) -6oz-170gx100", boxSize: "A", perCarton: 100, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBS01", productName: "Vitaday - Buffalo Treats Stick (Small) 227g*70", boxSize: "A", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBS03", productName: "Vitaday - Buffalo Treats Stick (Medium) 227g*70", boxSize: "A", perCarton: 70, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBB01", productName: "Vitaday - Buffalo Treats Bone Shaped 227g*60", boxSize: "A", perCarton: 60, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "VBW01", productName: "Vitaday - Buffalo Treats W Shaped 227g*80", boxSize: "A", perCarton: 80, perPack: null, perBox: null, perPallet: 42, country: "VN" },
  { productCode: "EZD011AM", productName: "Herz Grain-Free U.S.A. Turkey Breast Recipe (908g/Pk)", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD021AM", productName: "Herz Grain-Free Australian Lamb Recipe (908g/Pk)", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD041AM", productName: "Herz Grain-Free New Zealand Grass-Fed Beef Recipe (908g/Pk)", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD051AM", productName: "Herz Grain-Free New Zealand Venison Recipe (908g/Pk)", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD061AM", productName: "Herz Grain-Free U.S.A. Chicken Recipe (908g/Pk)", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD010AM", productName: "Herz Grain-Free U.S.A. Turkey Breast Recipe (100g/Pk)", boxSize: "D", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD020AM", productName: "Herz Grain-Free Australian Lamb Recipe (100g/Pk)", boxSize: "D", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD040AM", productName: "Herz Grain-Free New Zealand Grass-Fed Beef Recipe (100g/Pk)", boxSize: "D", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD050AM", productName: "Herz Grain-Free New Zealand Venison Recipe (100g/Pk)", boxSize: "D", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD060AM", productName: "Herz Grain-Free U.S.A. Chicken Recipe (100g/Pk)", boxSize: "D", perCarton: 100, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD010AM-3", productName: "Herz Grain-Free U.S.A. Turkey Breast Recipe (100g/Pk)", boxSize: "D", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD020AM-3", productName: "Herz Grain-Free Australian Lamb Recipe (100g/Pk)", boxSize: "D", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD040AM-3", productName: "Herz Grain-Free New Zealand Grass-Fed Beef Recipe (100g/Pk)", boxSize: "D", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD050AM-3", productName: "Herz Grain-Free New Zealand Venison Recipe (100g/Pk)", boxSize: "D", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "EZD060AM-3", productName: "Herz Grain-Free U.S.A. Chicken Recipe (100g/Pk)", boxSize: "D", perCarton: 90, perPack: 3, perBox: null, perPallet: 36, country: "TW" },
{ productCode: "EPD011J", productName: "Herz Premium Canine Cuisine ‚Äì Turkey with Duck Liver Recipe, 1kg", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD021J", productName: "Premium Canine Cuisine-Lamb with Duck Liver Ricipe-1kg", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD041J", productName: "Premium Canine Cuisine-Beef with Duck Liver Ricipe-1kg", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD061J", productName: "Premium Canine Cuisine-Chicken with Duck Liver Ricipe-1kg", boxSize: "D", perCarton: 18, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD010J", productName: "Premium Canine Cuisine ‚Äì Turkey with Duck Liver Recipe-454g", boxSize: "D", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD020J", productName: "Premium Canine Cuisine-Lamb with Duck Liver Ricipe-454g", boxSize: "D", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD040J", productName: "Premium Canine Cuisine-Beef with Duck Liver Ricipe-454g", boxSize: "D", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "EPD060J", productName: "Premium Canine Cuisine-Chicken with Duck Liver Ricipe-454g", boxSize: "D", perCarton: 30, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "GTSL01J", productName: "Gootoe - Turkey Tendon Strip", boxSize: "B", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTRL05J", productName: "Gootoe - Turkey Tendon Ring_L", boxSize: "B", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTPL05J", productName: "Gootoe - Turkey Tendon Rope_L", boxSize: "B", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTBL05J", productName: "Gootoe - Turkey Tendon Bone_L", boxSize: "B", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTRL01J", productName: "Gootoe - Turkey Tendon Ring_S", boxSize: "B", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTPL01J", productName: "Gootoe - Turkey Tendon Rope_S", boxSize: "B", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTBL01J", productName: "Gootoe - Turkey Tendon Bone_S", boxSize: "B", perCarton: 24, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GSF01J", productName: "Gootoe -Turkey Tendon Pumpkin Strip", boxSize: "B", perCarton: 150, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTR01J", productName: "Gootoe - Turkey Tendon Ring_S", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTR03J", productName: "Gootoe - Turkey Tendon Ring_M", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTB01J", productName: "Gootoe - Turkey Tendon Bone_S", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTB03J", productName: "Gootoe - Turkey Tendon Bone_M", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTB05J", productName: "Gootoe - Turkey Tendon Bone_L", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTP01J", productName: "Gootoe - Turkey Tendon Rope_S", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTP03J", productName: "Gootoe - Turkey Tendon Rope _M", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTP05J", productName: "Gootoe - Turkey Tendon Rope _L", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTS01J", productName: "Gootoe - Turkey Tendon Strip", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTS03J", productName: "Gootoe - Turkey Tendon Stick_M", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTZ01J", productName: "Gootoe - Turkey Tendon Pretzel_S", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTZ03J", productName: "Gootoe - Turkey Tendon Pretzel_M", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "GTA01J", productName: "Gootoe - Turkey Tendon Braid", boxSize: "B", perCarton: 100, perPack: null, perBox: null, perPallet: 12, country: "TW" },
  { productCode: "KTB01J", productName: "Natural Turkey Tendon Bone_S", boxSize: "B", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "KTB03J", productName: "Natural Turkey Tendon Bone_ M", boxSize: "B", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "KTB05J", productName: "Natural Turkey Tendon Bone_L", boxSize: "B", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "KTB06J", productName: "Natural Turkey Tendon Lollipop", boxSize: "B", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "TTR01J", productName: "Natural Turkey Tendon Ring_ S", boxSize: "B", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "TTR03J", productName: "Natural Turkey Tendon Ring_ M", boxSize: "B", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTR05J", productName: "Natural Turkey Tendon Ring_ L", boxSize: "B", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "TRP01J", productName: "Natural Turkey Tendon Rope_ S", boxSize: "B", perCarton: 320, perPack: null, perBox: 40, perPallet: 12, country: "TW" },
  { productCode: "TRP03J", productName: "Natural Turkey Tendon Rope_ M", boxSize: "B", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TRP05J", productName: "Natural Turkey Tendon Rope_ L", boxSize: "B", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "TTS05J", productName: "Natural Turkey Tendon Strip", boxSize: "B", perCarton: 80, perPack: null, perBox: 10, perPallet: 12, country: "TW" },
  { productCode: "TTA01J", productName: "Turkey Tendon Rice Stick", boxSize: "B", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTA02J", productName: "Turkey Tendon Chicken Stick", boxSize: "B", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTA03J", productName: "Turkey Tendon Thin Stick", boxSize: "B", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "TTA04J", productName: "Turkey Tendon Pumpkin Strip", boxSize: "B", perCarton: 160, perPack: null, perBox: 20, perPallet: 12, country: "TW" },
  { productCode: "GRB01AM", productName: "Gootoe - Veal Rib Bone, 85g", boxSize: "D", perCarton: 130, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "GRB01J", productName: "Gootoe - Veal Rib Bone, 85g", boxSize: "D", perCarton: 130, perPack: null, perBox: null, perPallet: 21, country: "TW" },
  { productCode: "ART01AM", productName: "Afreschi - Turkey Tendon Wrapped Veal Rib Bone, 85g", boxSize: "D", perCarton: 130, perPack: null, perBox: null, perPallet: 36, country: "TW" },
  { productCode: "ART01J", productName: "Afreschi - Turkey Tendon Wrapped Veal Rib Bone, 85g", boxSize: "D", perCarton: 130, perPack: null, perBox: null, perPallet: 21, country: "TW" }
];

    const boxSizePalletMap = {A: 42, B: 36, C: 30, D: 36};
    let currentCountry = 'VN';

    function showTip(msg, type="info") {
      let tip = document.createElement('div');
      tip.className = 'user-tip ' + type;
      tip.innerText = msg;
      document.body.appendChild(tip);
      setTimeout(()=>{ tip.style.opacity=0; setTimeout(()=>tip.remove(),450); }, 1800);
    }

    function getFilteredProducts(){
      if(currentCountry === 'Others'){
        return allProducts.filter(p => p.country !== 'VN' && p.country !== 'TW');
      }
      return allProducts.filter(p => p.country === currentCountry);
    }

    window.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('[name="countrySelect"]').forEach(radio => {
        radio.addEventListener('change', (e) => {
          currentCountry = e.target.value;
          reloadData();
        });
      });
      reloadData();
      packagingTypeChanged();
      boxSizeChanged();
    });

    function reloadData(){
      document.getElementById('searchInput').value = '';
      document.getElementById('searchResults').innerHTML = '';
      document.getElementById('searchResults').style.display = 'none';
      clearTable();
      updateTotals();
    }
    function clearTable(){
      document.querySelector('#productTable tbody').innerHTML = '';
    }

    // ÊêúÂ∞ãÂìÅËôü/Âø´ÈÄüÊñ∞Â¢û
    function searchProduct(){
      const val = document.getElementById('searchInput').value.trim().toUpperCase();
      const res = document.getElementById('searchResults');
      res.innerHTML = '';
      if(!val){
        res.style.display='none';
        return;
      }
      const matched = getFilteredProducts().filter(p => p.productCode.toUpperCase().includes(val));
      if(matched.length > 0){
        res.style.display='block';
        matched.forEach(prod=>{
          const item = document.createElement('div');
          item.className = 'search-result-item';
          item.textContent = `${prod.productCode} - ${prod.productName}`;
          item.onclick = () => {
            addProduct(prod);
            document.getElementById('searchInput').value = '';
            res.innerHTML = '';
            res.style.display = 'none';
          };
          res.appendChild(item);
        });
      } else {
        res.style.display='none';
      }
    }

    function addProduct(prod){
      const tbody = document.querySelector('#productTable tbody');
      if(Array.from(tbody.querySelectorAll('tr')).some(r => r.cells[1].textContent === prod.productCode)){
        showTip('Ë©≤Áî¢ÂìÅÂ∑≤Âú®ÂàóË°®', 'error');
        return;
      }
      const rowIndex = tbody.children.length + 1;
      const {hasPack, hasBox} = checkPackageType(prod);
      let packOrBoxInput = '-';
      if(hasPack){
        packOrBoxInput = `<input type="number" class="edit-pack-input" placeholder="Ë¢ãÊï∏" oninput="updateFields(this,'${prod.productCode}')">`;
      } else if(hasBox){
        packOrBoxInput = `<input type="number" class="edit-box-input" placeholder="ÁõíÊï∏" oninput="updateFields(this,'${prod.productCode}')">`;
      }
      const targetPlaceholder = hasPack ? 'ÁõÆÊ®ôË¢ãÊï∏' : (hasBox ? 'ÁõÆÊ®ôÁõíÊï∏' : 'ÁõÆÊ®ôÂåÖÊï∏');
      const rowHTML = `
      <tr data-product="${prod.productCode}">
        <td>${rowIndex}</td>
        <td>${prod.productCode}</td>
        <td><input type="number" class="edit-quantity-input" placeholder="ÂåÖÊï∏" oninput="updateFields(this,'${prod.productCode}')"></td>
        <td>${packOrBoxInput}</td>
        <td><input type="number" class="target-input" placeholder="${targetPlaceholder}" oninput="checkTarget(this)"></td>
        <td><input type="number" class="edit-cartons-input" placeholder="ÁÆ±Êï∏" oninput="updateFields(this,'${prod.productCode}')"></td>
        <td><input type="number" class="edit-pallets-input" placeholder="Ê£ßÊùøÊï∏" oninput="updateFields(this,'${prod.productCode}')"></td>
        <td class="box-size-${prod.boxSize}">
          <span class="box-size-icon box-size-icon-${prod.boxSize}"></span>${prod.boxSize}
        </td>
        <td class="action-button-group">
          <button type="button" class="action-button" onclick="moveUp(this)" title="‰∏äÁßª"><i class="fa-solid fa-arrow-up"></i></button>
          <button type="button" class="action-button" onclick="moveDown(this)" title="‰∏ãÁßª"><i class="fa-solid fa-arrow-down"></i></button>
          <button type="button" class="lock-button" onclick="toggleLock(this)" title="ÈéñÂÆö/Ëß£Èéñ"><i class="fa-solid fa-lock"></i></button>
          <button type="button" class="remove-button" onclick="removeRow(this)" title="Âà™Èô§"><i class="fa-solid fa-trash"></i></button>
        </td>
      </tr>`;
      tbody.insertAdjacentHTML('beforeend', rowHTML);
      updateRowNumbers();
      showTip('Â∑≤Âä†ÂÖ•Áî¢ÂìÅ', 'success');
    }
    function checkPackageType(prod){
      const hasPack = (typeof prod.perPack !== 'undefined' && prod.perPack > 0);
      const hasBox = (typeof prod.perBox !== 'undefined' && prod.perBox > 0 && !hasPack);
      return {hasPack, hasBox};
    }
    function getProductSpecByCode(code){
      return allProducts.find(p => p.productCode === code) || null;
    }
    function updateFields(input, productCode){
      const row = input.closest('tr');
      const prod = getProductSpecByCode(productCode);
      if(!prod) return;
      let {quantity, units, cartons, pallets} = getCurrentValues(row);
      const {perPack=0, perBox=0, perCarton=1, perPallet=1} = prod;
      const changedField = getChangedField(input);
      ({quantity, units, cartons, pallets} = recalcValues(changedField, {quantity, units, cartons, pallets, perPack, perBox, perCarton, perPallet}));
      if(changedField !== 'quantity' && row.querySelector('.edit-quantity-input')){
        row.querySelector('.edit-quantity-input').value = quantity.toFixed(0);
      }
      const packInput = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
      if(packInput && changedField !== 'units'){
        packInput.value = units.toFixed(2);
      }
      if(changedField !== 'cartons' && row.querySelector('.edit-cartons-input')){
        row.querySelector('.edit-cartons-input').value = cartons.toFixed(2);
      }
      if(changedField !== 'pallets' && row.querySelector('.edit-pallets-input')){
        row.querySelector('.edit-pallets-input').value = pallets.toFixed(2);
      }
      const target = row.querySelector('.target-input');
      if(target) checkTarget(target);
      updateTotals();
    }
    function getChangedField(input){
      if(input.classList.contains('edit-quantity-input')) return 'quantity';
      if(input.classList.contains('edit-pack-input') || input.classList.contains('edit-box-input')) return 'units';
      if(input.classList.contains('edit-cartons-input')) return 'cartons';
      if(input.classList.contains('edit-pallets-input')) return 'pallets';
      return '';
    }
    function getCurrentValues(row){
      const quantity = parseFloat(row.querySelector('.edit-quantity-input')?.value) || 0;
      let units = 0;
      const packOrBox = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
      if(packOrBox){
        units = parseFloat(packOrBox.value) || 0;
      }
      const cartons = parseFloat(row.querySelector('.edit-cartons-input')?.value) || 0;
      const pallets = parseFloat(row.querySelector('.edit-pallets-input')?.value) || 0;
      return {quantity, units, cartons, pallets};
    }
    function recalcValues(changedField, vals){
      let {quantity, units, cartons, pallets, perPack, perBox, perCarton, perPallet} = vals;
      const isBag = (perPack > 0);
      const isBox = (perBox > 0 && !isBag);
      const isSingle = (!isBag && !isBox);
      if(isBag){
        switch(changedField){
          case 'quantity': units = quantity / perPack; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'units': quantity = units * perPack; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'cartons': units = cartons * perCarton; quantity = units * perPack; pallets = cartons / perPallet; break;
          case 'pallets': cartons = pallets * perPallet; units = cartons * perCarton; quantity = units * perPack; break;
        }
      }
      else if(isBox){
        switch(changedField){
          case 'quantity': units = quantity / perBox; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'units': quantity = units * perBox; cartons = units / perCarton; pallets = cartons / perPallet; break;
          case 'cartons': units = cartons * perCarton; quantity = units * perBox; pallets = cartons / perPallet; break;
          case 'pallets': cartons = pallets * perPallet; units = cartons * perCarton; quantity = units * perBox; break;
        }
      }
      else if(isSingle){
        switch(changedField){
          case 'quantity': cartons = quantity / perCarton; pallets = cartons / perPallet; break;
          case 'cartons': quantity = cartons * perCarton; pallets = cartons / perPallet; break;
          case 'pallets': cartons = pallets * perPallet; quantity = cartons * perCarton; break;
        }
      }
      return {quantity, units, cartons, pallets};
    }
    function checkTarget(targetInput){
      const row = targetInput.closest('tr');
      let currentVal = 0;
      const packOrBox = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
      if(packOrBox){
        currentVal = parseFloat(packOrBox.value) || 0;
      } else {
        currentVal = parseFloat(row.querySelector('.edit-quantity-input').value) || 0;
      }
      const tVal = parseFloat(targetInput.value) || 0;
      if(tVal > 0 && currentVal >= tVal){
        targetInput.style.backgroundColor = '#23c87d';
        targetInput.style.color = '#fff';
      } else if (tVal > 0) {
        targetInput.style.backgroundColor = '#fa5353';
        targetInput.style.color = '#fff';
      } else {
        targetInput.style.backgroundColor = '';
        targetInput.style.color = '';
      }
    }
    function toggleLock(btn){
      const row = btn.closest('tr');
      const isLocked = row.classList.contains('locked');
      row.querySelectorAll('input').forEach(inp => inp.disabled = !isLocked);
      row.classList.toggle('locked', !isLocked);
      btn.innerHTML = isLocked ? '<i class="fa-solid fa-lock"></i>' : '<i class="fa-solid fa-lock-open"></i>';
      showTip(isLocked ? 'Â∑≤Ëß£ÈéñÊ≠§Âàó' : 'Â∑≤ÈéñÂÆöÊ≠§Âàó', isLocked ? 'success' : 'info');
    }
    function removeRow(btn){
      btn.closest('tr').remove();
      updateRowNumbers();
      updateTotals();
      showTip('Â∑≤Âà™Èô§Áî¢ÂìÅ', 'success');
    }
    function moveUp(btn){
      const tr = btn.closest('tr');
      const prev = tr.previousElementSibling;
      if(prev) tr.parentNode.insertBefore(tr, prev);
      updateRowNumbers();
    }
    function moveDown(btn){
      const tr = btn.closest('tr');
      const next = tr.nextElementSibling;
      if(next) tr.parentNode.insertBefore(next, tr);
      updateRowNumbers();
    }
    function updateRowNumbers(){
      const rows = document.querySelectorAll('#productTable tbody tr');
      rows.forEach((r, i) => { r.cells[0].textContent = i + 1; });
    }
    function updateTotals(){
      let totalQuantity = 0, totalCartons = 0, totalPallets = 0;
      const palletCounts = { A:0, B:0, C:0, D:0 };
      document.querySelectorAll('.edit-quantity-input').forEach(i => {
        totalQuantity += parseFloat(i.value) || 0;
      });
      document.querySelectorAll('.edit-cartons-input').forEach(i => {
        totalCartons += parseFloat(i.value) || 0;
      });
      const rows = document.querySelectorAll('#productTable tbody tr');
      rows.forEach(row => {
        const pVal = parseFloat(row.querySelector('.edit-pallets-input').value) || 0;
        const bSize = row.cells[7].textContent.trim();
        if(palletCounts.hasOwnProperty(bSize)){
          palletCounts[bSize] += pVal;
        }
      });
      totalPallets = palletCounts.A + palletCounts.B + palletCounts.C + palletCounts.D;
      document.getElementById('totalQuantity').textContent = totalQuantity.toFixed(0);
      document.getElementById('totalCartons').textContent = totalCartons.toFixed(2);
      document.getElementById('totalPallets').textContent = totalPallets.toFixed(2);
      document.getElementById('countA').textContent = palletCounts.A.toFixed(2);
      document.getElementById('countB').textContent = palletCounts.B.toFixed(2);
      document.getElementById('countC').textContent = palletCounts.C.toFixed(2);
      updateContainerInfo(totalPallets);
    }
    function updateContainerInfo(totalPallets){
      const infoDiv = document.getElementById('containerInfo');
      infoDiv.innerHTML = '';
      let remaining = totalPallets;
      let containerCount = 1;
      while(remaining > 0){
        let type, cap;
        if(remaining <= 10){
          type = '20 Â∞∫Ë≤®Ê´É';
          cap = 10;
        } else {
          type = '40 Â∞∫Ë≤®Ê´É';
          cap = 20;
        }
        let use = Math.min(remaining, cap);
        let fillRate = (use/cap)*100;
        let cDiv = document.createElement('div');
        cDiv.innerHTML = `<strong style="font-size:1.05rem;">Ë≤®Ê´É ${containerCount}Ôºö${type}Ôºà${fillRate.toFixed(0)}%Ôºâ</strong>`;
        let pc = document.createElement('div');
        pc.className = 'progress-container';
        let pb = document.createElement('div');
        pb.className = 'progress-bar';
        pb.style.width = fillRate + '%';
        pb.textContent = `${use} / ${cap} Ê£ßÊùø`;
        pc.appendChild(pb);
        cDiv.appendChild(pc);
        infoDiv.appendChild(cDiv);
        remaining -= use;
        containerCount++;
      }
    }
    function exportToExcel() {
      const wb = XLSX.utils.book_new();
      const orderSheetData = [];
      const orderHeader = ["Â∫èËôü","ÂìÅËôü","ÂêçÁ®±","ÊØèÁÆ±","ÂåÖË£ùÈ°ûÂûã","ÁÆ±Êï∏","ÂñÆ‰Ωç","Ê£ßÊùøÊï∏","ÂñÆ‰Ωç"];
      orderSheetData.push(orderHeader);
      const rows = document.querySelectorAll('#productTable tbody tr');
      rows.forEach(row => {
        const idx = row.cells[0].textContent;
        const code = row.cells[1].textContent;
        const prod = allProducts.find(p => p.productCode === code);
        if(!prod) return;
        const name = prod.productName || '';
        const eachCarton = prod.perCarton || 1;
        let pkgType = 'ÂñÆÂåÖ';
        if(prod.perPack && prod.perPack > 0) pkgType = 'Ë¢ãË£ù';
        else if(prod.perBox && prod.perBox > 0) pkgType = 'ÁõíË£ù';
        const cVal = parseFloat(row.querySelector('.edit-cartons-input')?.value) || 0;
        const pVal = parseFloat(row.querySelector('.edit-pallets-input')?.value) || 0;
        orderSheetData.push([
          idx, code, name, eachCarton, pkgType, cVal, "ÁÆ±", pVal, "Ê£ßÊùø"
        ]);
      });
      const wsOrder = XLSX.utils.aoa_to_sheet(orderSheetData);
      XLSX.utils.book_append_sheet(wb, wsOrder, "Ë®ÇÂñÆ");
      const detailSheetData = [];
      const detailHeader = ["Â∫èËôü","ÂìÅËôü","ÂêçÁ®±","ÂåÖÊï∏","Ë¢ãÊï∏/ÁõíÊï∏","ÁÆ±Êï∏","Ê£ßÊùøÊï∏","Á¥ôÁÆ±Ë¶èÊ†º"];
      detailSheetData.push(detailHeader);
      rows.forEach(row => {
        const idx = row.cells[0].textContent;
        const code = row.cells[1].textContent;
        const prod = allProducts.find(p => p.productCode === code);
        if(!prod) return;
        const name = prod.productName || '';
        const quantity = parseFloat(row.querySelector('.edit-quantity-input')?.value) || 0;
        let packOrBoxVal = '‚Äî';
        const packOrBoxInput = row.querySelector('.edit-pack-input') || row.querySelector('.edit-box-input');
        if (packOrBoxInput) {
          const val = parseFloat(packOrBoxInput.value);
          if (val && !isNaN(val)) packOrBoxVal = val;
        }
        const cartons = parseFloat(row.querySelector('.edit-cartons-input')?.value) || 0;
        const pallets = parseFloat(row.querySelector('.edit-pallets-input')?.value) || 0;
        const boxSize = row.cells[7].textContent.trim();
        detailSheetData.push([
          idx, code, name, quantity, packOrBoxVal, cartons, pallets, boxSize
        ]);
      });
      const wsDetail = XLSX.utils.aoa_to_sheet(detailSheetData);
      XLSX.utils.book_append_sheet(wb, wsDetail, "Ë©≥ÊÉÖ");
      const dateStr = getTodayString();
      XLSX.writeFile(wb, `Ë®ÇÂñÆ${currentCountry}_${dateStr}.xlsx`);
      showTip("Â∑≤ÂåØÂá∫ Excel", "success");
    }
    function getTodayString(){
      const now = new Date();
      let mm = String(now.getMonth() + 1).padStart(2, "0");
      let dd = String(now.getDate()).padStart(2, "0");
      return mm + dd;
    }
    function openModal(){
      document.getElementById('boxSizeModal').style.display = 'block';
    }
    function closeModal(){
      document.getElementById('boxSizeModal').style.display = 'none';
    }
    window.onclick = (e) => {
      if(e.target === document.getElementById('boxSizeModal')) closeModal();
      if(e.target === document.getElementById('newItemModal')) closeNewItemModal();
    }
    // Êñ∞ÂìÅÁî¢ÁîüÂô®
    document.getElementById('newItemGeneratorBtn').addEventListener('click', openNewItemModal);
    function openNewItemModal(){
      document.getElementById('newItemModal').style.display = 'block';
    }
    function closeNewItemModal(){
      document.getElementById('newItemModal').style.display = 'none';
    }
    function boxSizeChanged(){
      const val = document.getElementById('newItemBoxSize').value;
      document.getElementById('newItemPallet').value = boxSizePalletMap[val] || 42;
    }
    function packagingTypeChanged(){
      const type = document.getElementById('newItemPackagingType').value;
      const container = document.getElementById('packagingFields');
      container.innerHTML = '';
      if(type === 'bag'){
        container.innerHTML +=
          '<label>ÊØèÁÆ±Ë¢ãÊï∏ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerCartonBag" placeholder="ÂøÖÂ°´"></label>';
        container.innerHTML +=
          '<label>ÊØèË¢ãÂπæÂÖ• <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerPack" placeholder="ÂøÖÂ°´"></label>';
      } else if(type === 'box'){
        container.innerHTML +=
          '<label>ÊØèÁÆ±ÁõíÊï∏ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerCartonBox" placeholder="ÂøÖÂ°´"></label>';
        container.innerHTML +=
          '<label>ÊØèÁõíÂπæÂÖ• <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerBoxBox" placeholder="ÂøÖÂ°´"></label>';
      } else {
        container.innerHTML +=
          '<label>ÊØèÁÆ±ÂåÖÊï∏ <span style="color:#eb3d3d">*</span><input type="number" id="newItemPerCartonSingle" placeholder="ÂøÖÂ°´"></label>';
      }
    }
    function addNewItemLine(){
      const code = document.getElementById('newItemCode').value.trim();
      const name = document.getElementById('newItemName').value.trim();
      const boxSize = document.getElementById('newItemBoxSize').value;
      const pal = document.getElementById('newItemPallet').value.trim();
      const countryVal = document.getElementById('newItemCountry').value;
      const pkgType = document.getElementById('newItemPackagingType').value;
      if(!code || !name || !pal){
        showTip("Ë´ãÂ°´ÂÆåÊï¥ÂìÅËôü/ÂìÅÂêç/Ê£ßÊùøÊï∏", "error");
        return;
      }
      let itemStr = `{productCode:"${code}", productName:"${name}", boxSize:"${boxSize}", perPallet:${pal}, country:"${countryVal}"`;
      if(pkgType === 'bag'){
        const cBag = document.getElementById('newItemPerCartonBag').value.trim();
        const pack = document.getElementById('newItemPerPack').value.trim();
        if(!cBag || !pack){
          showTip("Ë¢ãË£ùÈúÄÂ°´ÊØèÁÆ±Ë¢ãÊï∏„ÄÅÊØèË¢ãÂπæÂÖ•", "error");
          return;
        }
        itemStr += `, perCarton:${cBag}, perPack:${pack}, perBox:null`;
      } else if(pkgType === 'box'){
        const cBox = document.getElementById('newItemPerCartonBox').value.trim();
        const bBox = document.getElementById('newItemPerBoxBox').value.trim();
        if(!cBox || !bBox){
          showTip("ÁõíË£ùÈúÄÂ°´ÊØèÁÆ±ÁõíÊï∏„ÄÅÊØèÁõíÂπæÂÖ•", "error");
          return;
        }
        itemStr += `, perCarton:${cBox}, perBox:${bBox}, perPack:null`;
      } else {
        const single = document.getElementById('newItemPerCartonSingle').value.trim();
        if(!single){
          showTip("ÂñÆÂåÖÈúÄÂ°´ÊØèÁÆ±ÂåÖÊï∏", "error");
          return;
        }
        itemStr += `, perCarton:${single}, perPack:null, perBox:null`;
      }
      itemStr += '},';
      const area = document.getElementById('newItemResult');
      const currVal = area.value.trim();
      area.value = currVal ? (currVal + ' ' + itemStr) : itemStr;
      resetNewItemForm();
      showTip('Â∑≤Áî¢ÁîüÊñ∞ÂïÜÂìÅË≥áË®ä', 'success');
    }
    function resetNewItemForm(){
      document.getElementById('newItemCode').value = '';
      document.getElementById('newItemName').value = '';
      document.getElementById('newItemBoxSize').value = 'A';
      boxSizeChanged();
      document.getElementById('newItemCountry').value = 'VN';
      document.getElementById('newItemPackagingType').value = 'single';
      packagingTypeChanged();
      document.getElementById('newItemPallet').value = boxSizePalletMap['A'];
    }
    function copyNewItems(){
      const area = document.getElementById('newItemResult');
      if(navigator.clipboard && window.isSecureContext){
        navigator.clipboard.writeText(area.value).then(()=>{
          showTip("Â∑≤Ë§áË£ΩÁµêÊûú", "success");
        },()=>{
          showTip("Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïË§áË£Ω„ÄÇ", "error");
        });
      } else {
        area.select();
        document.execCommand("copy");
        showTip("Â∑≤Ë§áË£ΩÁµêÊûú", "success");
      }
    }
  </script>
</body>
</html>
